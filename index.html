<!DOCTYPE html><html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Earn App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body{margin:0;font-family:sans-serif;background:#020617;color:#fff}
.card{background:#0f172a;padding:15px;border-radius:12px;margin-bottom:10px}
button{width:100%;padding:12px;border:none;border-radius:8px;background:#22c55e;font-size:16px;margin-top:8px}
.opt{background:#334155;color:#fff}
.small{font-size:13px;opacity:.8}
</style>
</head>
<body>
<div class="card" id="user"></div>
<div class="card" id="quiz">Loading...</div>
<div class="card">
<button onclick="withdraw()">üí∏ Withdraw</button>
<p class="small" id="msg"></p>
</div><script>
const tg = Telegram.WebApp; tg.ready();
const API = "https://YOUR_BACKEND_URL"; // replace with your Railway backend URL
const user = tg.initDataUnsafe.user;

document.getElementById('user').innerHTML = `üë§ ${user.first_name}<br>üí∞ Balance: <span id='bal'>0</span>‡ß≥`;

async function api(path, data = {}) {
    return fetch(API + path, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({...data, uid: user.id})
    }).then(r => r.json());
}

async function load() {
    // Load balance
    const b = await api('/balance');
    document.getElementById('bal').innerText = b.balance.toFixed(2);

    // Load question
    const q = await api('/question');
    if (!q.question) {document.getElementById('quiz').innerHTML='‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶∂‡ßá‡¶∑'; return;}
    let h = `<h3>${q.question}</h3>`;
    q.options.forEach((o,i)=> h += `<button class='opt' onclick='answer(${i})'>${o}</button>`);
    document.getElementById('quiz').innerHTML = h;
}

async function answer(i) {
    const r = await api('/answer',{answer: i});
    alert(r.message);
    await load();
    showMonetagAd();
}

async function withdraw() {
    const r = await api('/withdraw');
    document.getElementById('msg').innerText = r.message;
}

// Referral system: simple example, called on app start
async function applyReferral(referrerId) {
    const r = await api('/referral',{referrer: referrerId, referee: user.id});
    console.log(r.message);
}

// Monetag Ads Hook
function showMonetagAd() {
    const adZone = 'quiz_earn_bd_bot_inapp_interstitial';
    console.log('Monetag Ad Triggered: ', adZone);
    // actual Monetag JS SDK call goes here
}

load();
</script></body>
</html>
